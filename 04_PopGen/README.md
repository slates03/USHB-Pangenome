# REHH

Finally, Rsb was used to measure any divergence from random patterns of segregation in a target population (e.g., Pol-line, Italian), increasing the degree of linkage between variants. At first, we phased the dataset with SHAPEIT v2.r790 using genetic maps generated from a previous study. This enabled the recovery of missing SNP calls that would otherwise have been disregarded during the calculation of the Rsb statistic. The imputed SNP matrix was converted to the haplotype data format required by the rehh package in R. 

Once all of the files had been created, a looping function was used to iteratively apply the scan_hh function from the rehh packages. The scan_hh function scanned the haplotype files with the mapping file as reference, calculating population- and scaffold-specific statistical precursors to Rsb.This allowed the rescue of missing SNP calls which would have otherwise been discarded during the calculation of the Rsb statistic. The imputed SNP matrix was re-formatted to a haplotype data format required by the rehh package in R. Once all the files were generated, a looping function was used to iteratively apply the scan_hh function in the rehh packages. The scan_hh function scanned the haplotype files using the mapping file as reference, calculating population- and scaffold-specific statistical precursors to Rsb. The concatenated output files contained the position information of each SNP (CHR, POS columns), the reference (REF) allele frequency (freq_A), the iHH metric for both the reference and alternate (ALT) alleles (iHH_A and iHH_D), and two iES calculations. The ies2rsb function calculates Rsb directly. The results represent the integrated area under the haplotype homozygosity curve as the haplotype extends outwards from each individual SNP in both directions. The median difference in the logarithmic ratio of iES between two populations for each SNP i (ln(Rsb i)') produces ln(Rsb i), a normally distributed measure of fold change deviation between iES. A positive fold change suggests slower haplotype degradation in the dividend population, corresponding to higher linkage.

# 02_CSS.R

We used a Composite Selection Score (CSS) based on previous methods [47]. We first gave a fractional rank to each variable (e.g., ratio nucleotide diversity, logarithmic ratio of iES, SNP contribution, and Fst), which was then converted into a Z-statistic. This produced an average Z-score per SNP, which was then compared to a normal distribution of Z-scores to determine the p-value. The CSS's p-value reflects how far the Z-score distribution deviates from what is expected. This deviation can be used to detect significant changes in signal strength or, when inverted (-Log10 of the p-value), as a detailed measure for identifying outliers. Using the identified haplotype blocks (See Methods), the maximum CSS scores for each block were determined. Then, blocks flanked by SVs specific to either Pol-line or Italian stock were isolated. We then identified SV flanked haplotype blocks with the highest max CSS score for downstream analysis. 
